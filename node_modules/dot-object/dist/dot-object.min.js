!function(t,e){"use strict";function r(t,e){var r,i;if("function"==typeof e)i=e(t),void 0!==i&&(t=i);else if(Array.isArray(e))for(r=0;r<e.length;r++)i=e[r](t),void 0!==i&&(t=i);return t}function i(t,e){return"-"===t[0]&&Array.isArray(e)&&/^-\d+$/.test(t)?e.length+parseInt(t,10):t}function n(t,e){return t.indexOf("[")>=0&&(t=t.replace(/\[/g,".").replace(/]/g,"")),t.split(e)}function o(t,e){return this instanceof o?("undefined"==typeof t&&(t="."),"undefined"==typeof e&&(e=!1),this.seperator=t,this.override=e,void(this.cleanup=[])):new o(t,e)}function s(t){return function(){return f[t].apply(f,arguments)}}function p(t){return"[object Object]"===Object.prototype.toString.call(t)}var f=new o(".",!1);o.prototype._fill=function(t,e,i,n){var o=t.shift();if(t.length>0){if(e[o]=e[o]||{},e[o]!==Object(e[o])){if(!this.override)throw new Error("Trying to redefine `"+o+"` which is a "+typeof e[o]);e[o]={}}this._fill(t,e[o],i,n)}else{if(e[o]===Object(e[o])&&Object.keys(e[o]).length)throw new Error("Trying to redefine non-empty obj['"+o+"']");e[o]=r(i,n)}},o.prototype.object=function(t,e){var i=this;Object.keys(t).forEach(function(n){var o=void 0===e?null:e[n];-1!==n.indexOf(i.seperator)?(i._fill(n.split(i.seperator),t,t[n],o),delete t[n]):i.override&&(t[n]=r(t[n],o))})},o.prototype.str=function(t,e,i,n){-1!==t.indexOf(this.seperator)?this._fill(t.split(this.seperator),i,e,n):this.override&&(i[t]=r(e,n))},o.prototype.pick=function(t,e,r){var o,s,p,f,c;for(s=n(t,this.seperator),o=0;o<s.length;o++){if(f=i(s[o],e),!(e&&"object"==typeof e&&f in e))return void 0;if(o===s.length-1)return r?(p=e[f],delete e[f],Array.isArray(e)&&(c=s.slice(0,-1).join("."),-1===this.cleanup.indexOf(c)&&this.cleanup.push(c)),p):e[f];e=e[f]}return r&&Array.isArray(e)&&(e=e.filter(function(t){return void 0!==t})),e},o.prototype.remove=function(t,e){var r;if(this.cleanup=[],Array.isArray(t)){for(r=0;r<t.length;r++)this.pick(t[r],e,!0);return this._cleanup(e),e}return this.pick(t,e,!0)},o.prototype._cleanup=function(t){var e,r,i,n;if(this.cleanup.length){for(r=0;r<this.cleanup.length;r++)i=this.cleanup[r].split("."),n=i.splice(0,-1).join("."),e=n?this.pick(n,t):t,e=e[i[0]].filter(function(t){return void 0!==t}),this.set(this.cleanup[r],e,t);this.cleanup=[]}},o.prototype.del=o.prototype.remove,o.prototype.move=function(t,e,i,n,o){return"function"==typeof n||Array.isArray(n)?this.set(e,r(this.pick(t,i,!0),n),i,o):(o=n,this.set(e,this.pick(t,i,!0),i,o)),i},o.prototype.transfer=function(t,e,i,n,o,s){return"function"==typeof o||Array.isArray(o)?this.set(e,r(this.pick(t,i,!0),o),n,s):(s=o,this.set(e,this.pick(t,i,!0),n,s)),n},o.prototype.copy=function(t,e,i,n,o,s){return"function"==typeof o||Array.isArray(o)?this.set(e,r(JSON.parse(JSON.stringify(this.pick(t,i,!1))),o),n,s):(s=o,this.set(e,this.pick(t,i,!1),n,s)),n},o.prototype.set=function(t,e,r,i){var o,s,f,c;if("undefined"==typeof e)return r;for(f=n(t,this.seperator),o=0;o<f.length;o++){if(c=f[o],o===f.length-1)if(i&&p(e)&&p(r[c]))for(s in e)e.hasOwnProperty(s)&&(r[c][s]=e[s]);else if(i&&Array.isArray(r[c])&&Array.isArray(e))for(var u=0;u<e.length;u++)r[f[o]].push(e[u]);else r[c]=e;else r.hasOwnProperty(c)&&(p(r[c])||Array.isArray(r[c]))||(r[c]=/^\d+$/.test(f[o+1])?[]:{});r=r[c]}return r},o.pick=s("pick"),o.move=s("move"),o.transfer=s("transfer"),o.copy=s("copy"),o.object=s("object"),o.str=s("str"),o.set=s("set"),o.del=o.remove=s("remove"),o._process=r,"function"==typeof define&&define.amd?define(function(){return o}):"undefined"!=typeof module&&module.exports?module.exports=o:t[e]=o}(this,"DotObject");